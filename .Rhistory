names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
# Fixed inputs
N_pop <- 1e6
gamma  <- 1/6
beta_step <- 7  # weekly blocks
out <- final_estimate_Rt_step(
incidence = df,
N = N_pop,
gamma = gamma,
beta_step = beta_step,
inits  = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5, rw_sd_beta = 0.2,
)
)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
# Fixed inputs
N_pop <- 1e6
gamma  <- 1/6
beta_step <- 7  # weekly blocks
out <- final_estimate_Rt_step(
incidence = df,
N = N_pop,
gamma = gamma,
beta_step = beta_step,
inits  = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5, rw_sd_beta = 0.2,
mean_I0 = log(10), sd_I0 = 0.6),
mcmc   = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
load_all()
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
# Fixed inputs
N_pop <- 1e6
gamma  <- 1/6
beta_step <- 7  # weekly blocks
out <- final_estimate_Rt_step(
incidence = df,
N = N_pop,
gamma = gamma,
beta_step = beta_step,
inits  = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5, rw_sd_beta = 0.2,
mean_I0 = log(10), sd_I0 = 0.6),
mcmc   = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
load_all()
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
# Fixed inputs
N_pop <- 1e6
gamma  <- 1/6
beta_step <- 7  # weekly blocks
out <- final_estimate_Rt_step(
incidence = df,
N = N_pop,
gamma = gamma,
beta_step = beta_step,
inits  = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5, rw_sd_beta = 0.2,
mean_I0 = log(10), sd_I0 = 0.6),
mcmc   = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
load_all()
devtools::load_all()
# Read incidence (time can start at any integer; must be consecutive)
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
beta_step = 7,  # weekly beta(t) blocks
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
devtools::load_all()
# Read incidence (time can start at any integer; must be consecutive)
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
beta_step = 7,  # weekly beta(t) blocks
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
devtools::load_all()
# Read incidence (time can start at any integer; must be consecutive)
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
beta_step = 7,  # weekly beta(t) blocks
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
beta_step = 7,
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
beta_step = 7,
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
devtools::load_all()
# Read incidence (time can start at any integer; must be consecutive)
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
beta_step = 7,  # weekly beta(t) blocks
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
devtools::load_all()
# Read incidence (time can start at any integer; must be consecutive)
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
beta_step = 7,  # weekly beta(t) blocks
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
devtools::load_all()
# Read incidence (time can start at any integer; must be consecutive)
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
beta_step = 7,  # weekly beta(t) blocks
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
beta_step = 7,
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
beta_step = 7,
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
beta_step = 7,
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
beta_breaks = c(17, 35)
inits = list(beta = 0.30, I0 = 10),
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
beta_breaks = c(17, 35),
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
beta_breaks = c(1,17, 35),
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
beta_breaks = c(1,17, 35),
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
beta_breaks = c(1,17, 35),
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
beta_breaks = c(1,17, 35),
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
beta_breaks = c(1,17, 35),
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
head(out$Rt_series)
out$diagnostics$acceptance_proxy
View(out)
summary(out$Rt_series)
plot(out$Rt_series)
View(out)
devtools::load_all()
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
beta_breaks = c(1,17, 35),
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
head(out$Rt_series)
out$diagnostics$acceptance_proxy
View(out)
plot(out$St_series)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e4,
gamma = 1/6,
beta_breaks = c(1,17, 35),
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
head(out$Rt_series)
out$diagnostics$acceptance_proxy
plot(out$St_series)
plot(out$Rt_series)
