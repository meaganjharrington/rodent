as.data.frame()
# 4) Run model
out <- estimate_Rt(
incidence = ebola_daily_incidence,
N = 100000,
gamma = 0.2
)
load_all()
# Load necessary libraries
library(dplyr)
library(outbreaks)
# Data
data(ebola_sierraleone_2014)
# 1) Build daily incidence data frame (time, cases)
ebola_daily_incidence <- ebola_sierraleone_2014 %>%
filter(!is.na(date_of_onset)) %>%
group_by(date_of_onset) %>%
summarise(cases = n(), .groups = "drop") %>%
arrange(date_of_onset) %>%
mutate(time = row_number()) %>%
select(time, cases) %>%
as.data.frame()
# 4) Run model
out <- estimate_Rt(
incidence = ebola_daily_incidence,
N = 100000,
gamma = 0.2
)
str(beta_blocks_samp)
browser()
ls()
str(extracted)
x
okay
console ()
load_all()
load_all()
# Load necessary libraries
library(dplyr)
library(outbreaks)
# Data
data(ebola_sierraleone_2014)
# 1) Build daily incidence data frame (time, cases)
ebola_daily_incidence <- ebola_sierraleone_2014 %>%
filter(!is.na(date_of_onset)) %>%
group_by(date_of_onset) %>%
summarise(cases = n(), .groups = "drop") %>%
arrange(date_of_onset) %>%
mutate(time = row_number()) %>%
select(time, cases) %>%
as.data.frame()
# 4) Run model
out <- estimate_Rt(
incidence = ebola_daily_incidence,
N = 100000,
gamma = 0.2
)
head(out$Rt_series)
out$Rt_plot # print Rt(t) plot over time
library(EpiEstim)
# Ebola SI parameters (tune if you have study-specific estimates)
mean_si <- 15    # days
std_si  <- 9.5   # days
library(dplyr)
ebola_sierraleone_2014_epiestim <- ebola_daily_incidence %>%
rename(I = cases)
res_parametric_si <- estimate_R(
incid  = ebola_sierraleone_2014_epiestim,       # data.frame with columns "date" (optional) and "I"
method = "parametric_si",
config = make_config(list(
mean_si = mean_si,
std_si  = std_si
))
)
library(ggplot2)
# Inspect and plot
head(res_parametric_si$R)
plot(res_parametric_si, legend = FALSE)      # full 3-panel plot
plot(res_parametric_si, "R") +               # Rt only
geom_hline(aes(yintercept = 1), lty = 2, col = "red")
load_all()
load_all()
# Load necessary libraries
library(dplyr)
library(outbreaks)
# Data
data(ebola_sierraleone_2014)
# 1) Build daily incidence data frame (time, cases)
ebola_daily_incidence <- ebola_sierraleone_2014 %>%
filter(!is.na(date_of_onset)) %>%
group_by(date_of_onset) %>%
summarise(cases = n(), .groups = "drop") %>%
arrange(date_of_onset) %>%
mutate(time = row_number()) %>%
select(time, cases) %>%
as.data.frame()
# 4) Run model
out <- estimate_Rt(
incidence = ebola_daily_incidence,
N = 100000,
gamma = 0.2
)
load_all()
# Load necessary libraries
library(dplyr)
library(outbreaks)
# Data
data(ebola_sierraleone_2014)
# 1) Build daily incidence data frame (time, cases)
ebola_daily_incidence <- ebola_sierraleone_2014 %>%
filter(!is.na(date_of_onset)) %>%
group_by(date_of_onset) %>%
summarise(cases = n(), .groups = "drop") %>%
arrange(date_of_onset) %>%
mutate(time = row_number()) %>%
select(time, cases) %>%
as.data.frame()
# 4) Run model
out <- estimate_Rt(
incidence = ebola_daily_incidence,
N = 100000,
gamma = 0.2
)
head(out$Rt_series)
out$Rt_plot # print Rt(t) plot over time
library(EpiEstim)
# Ebola SI parameters (tune if you have study-specific estimates)
mean_si <- 15    # days
std_si  <- 9.5   # days
library(dplyr)
ebola_sierraleone_2014_epiestim <- ebola_daily_incidence %>%
rename(I = cases)
res_parametric_si <- estimate_R(
incid  = ebola_sierraleone_2014_epiestim,       # data.frame with columns "date" (optional) and "I"
method = "parametric_si",
config = make_config(list(
mean_si = mean_si,
std_si  = std_si
))
)
library(ggplot2)
# Inspect and plot
head(res_parametric_si$R)
plot(res_parametric_si, legend = FALSE)      # full 3-panel plot
plot(res_parametric_si, "R") +               # Rt only
geom_hline(aes(yintercept = 1), lty = 2, col = "red")
str(Rt_outputs$beta_block_q)
ls()
ls()
load_all()
# Load necessary libraries
library(dplyr)
library(outbreaks)
# Data
data(ebola_sierraleone_2014)
# 1) Build daily incidence data frame (time, cases)
ebola_daily_incidence <- ebola_sierraleone_2014 %>%
filter(!is.na(date_of_onset)) %>%
group_by(date_of_onset) %>%
summarise(cases = n(), .groups = "drop") %>%
arrange(date_of_onset) %>%
mutate(time = row_number()) %>%
select(time, cases) %>%
as.data.frame()
# 4) Run model
out <- estimate_Rt(
incidence = ebola_daily_incidence,
N = 100000,
gamma = 0.2
)
head(out$Rt_series)
out$Rt_plot # print Rt(t) plot over time
library(EpiEstim)
# Ebola SI parameters (tune if you have study-specific estimates)
mean_si <- 15    # days
std_si  <- 9.5   # days
library(dplyr)
ebola_sierraleone_2014_epiestim <- ebola_daily_incidence %>%
rename(I = cases)
res_parametric_si <- estimate_R(
incid  = ebola_sierraleone_2014_epiestim,       # data.frame with columns "date" (optional) and "I"
method = "parametric_si",
config = make_config(list(
mean_si = mean_si,
std_si  = std_si
))
)
library(ggplot2)
# Inspect and plot
head(res_parametric_si$R)
plot(res_parametric_si, legend = FALSE)      # full 3-panel plot
plot(res_parametric_si, "R") +               # Rt only
geom_hline(aes(yintercept = 1), lty = 2, col = "red")
ls()
str(beta_block_q)
load_all()
# Load necessary libraries
library(dplyr)
library(outbreaks)
# Data
data(ebola_sierraleone_2014)
# 1) Build daily incidence data frame (time, cases)
ebola_daily_incidence <- ebola_sierraleone_2014 %>%
filter(!is.na(date_of_onset)) %>%
group_by(date_of_onset) %>%
summarise(cases = n(), .groups = "drop") %>%
arrange(date_of_onset) %>%
mutate(time = row_number()) %>%
select(time, cases) %>%
as.data.frame()
# 4) Run model
out <- estimate_Rt(
incidence = ebola_daily_incidence,
N = 100000,
gamma = 0.2
)
load_all()
load_all()
# Load necessary libraries
library(dplyr)
library(outbreaks)
# Data
data(ebola_sierraleone_2014)
# 1) Build daily incidence data frame (time, cases)
ebola_daily_incidence <- ebola_sierraleone_2014 %>%
filter(!is.na(date_of_onset)) %>%
group_by(date_of_onset) %>%
summarise(cases = n(), .groups = "drop") %>%
arrange(date_of_onset) %>%
mutate(time = row_number()) %>%
select(time, cases) %>%
as.data.frame()
# 4) Run model
out <- estimate_Rt(
incidence = ebola_daily_incidence,
N = 100000,
gamma = 0.2
)
load_all()
# Load necessary libraries
library(dplyr)
library(outbreaks)
# Data
data(ebola_sierraleone_2014)
# 1) Build daily incidence data frame (time, cases)
ebola_daily_incidence <- ebola_sierraleone_2014 %>%
filter(!is.na(date_of_onset)) %>%
group_by(date_of_onset) %>%
summarise(cases = n(), .groups = "drop") %>%
arrange(date_of_onset) %>%
mutate(time = row_number()) %>%
select(time, cases) %>%
as.data.frame()
# 4) Run model
out <- estimate_Rt(
incidence = ebola_daily_incidence,
N = 100000,
gamma = 0.2
)
str(beta_q)
str(beta_q)
# Load necessary libraries
library(dplyr)
library(outbreaks)
# Data
data(ebola_sierraleone_2014)
# 1) Build daily incidence data frame (time, cases)
ebola_daily_incidence <- ebola_sierraleone_2014 %>%
filter(!is.na(date_of_onset)) %>%
group_by(date_of_onset) %>%
summarise(cases = n(), .groups = "drop") %>%
arrange(date_of_onset) %>%
mutate(time = row_number()) %>%
select(time, cases) %>%
as.data.frame()
# 4) Run model
out <- estimate_Rt(
incidence = ebola_daily_incidence,
N = 100000,
gamma = 0.2
)
load_all()
# Load necessary libraries
library(dplyr)
library(outbreaks)
# Data
data(ebola_sierraleone_2014)
# 1) Build daily incidence data frame (time, cases)
ebola_daily_incidence <- ebola_sierraleone_2014 %>%
filter(!is.na(date_of_onset)) %>%
group_by(date_of_onset) %>%
summarise(cases = n(), .groups = "drop") %>%
arrange(date_of_onset) %>%
mutate(time = row_number()) %>%
select(time, cases) %>%
as.data.frame()
# 4) Run model
out <- estimate_Rt(
incidence = ebola_daily_incidence,
N = 100000,
gamma = 0.2
)
load_all()
# Load necessary libraries
library(dplyr)
library(outbreaks)
# Data
data(ebola_sierraleone_2014)
# 1) Build daily incidence data frame (time, cases)
ebola_daily_incidence <- ebola_sierraleone_2014 %>%
filter(!is.na(date_of_onset)) %>%
group_by(date_of_onset) %>%
summarise(cases = n(), .groups = "drop") %>%
arrange(date_of_onset) %>%
mutate(time = row_number()) %>%
select(time, cases) %>%
as.data.frame()
# 4) Run model
out <- estimate_Rt(
incidence = ebola_daily_incidence,
N = 100000,
gamma = 0.2
)
load_all()
# Load necessary libraries
library(dplyr)
library(outbreaks)
# Data
data(ebola_sierraleone_2014)
# 1) Build daily incidence data frame (time, cases)
ebola_daily_incidence <- ebola_sierraleone_2014 %>%
filter(!is.na(date_of_onset)) %>%
group_by(date_of_onset) %>%
summarise(cases = n(), .groups = "drop") %>%
arrange(date_of_onset) %>%
mutate(time = row_number()) %>%
select(time, cases) %>%
as.data.frame()
# 4) Run model
out <- estimate_Rt(
incidence = ebola_daily_incidence,
N = 100000,
gamma = 0.2
)
load_all()
# Load necessary libraries
library(dplyr)
library(outbreaks)
# Data
data(ebola_sierraleone_2014)
# 1) Build daily incidence data frame (time, cases)
ebola_daily_incidence <- ebola_sierraleone_2014 %>%
filter(!is.na(date_of_onset)) %>%
group_by(date_of_onset) %>%
summarise(cases = n(), .groups = "drop") %>%
arrange(date_of_onset) %>%
mutate(time = row_number()) %>%
select(time, cases) %>%
as.data.frame()
# 4) Run model
out <- estimate_Rt(
incidence = ebola_daily_incidence,
N = 100000,
gamma = 0.2
)
head(out$Rt_series)
out$Rt_plot # print Rt(t) plot over time
library(EpiEstim)
# Ebola SI parameters (tune if you have study-specific estimates)
mean_si <- 15    # days
std_si  <- 9.5   # days
library(dplyr)
ebola_sierraleone_2014_epiestim <- ebola_daily_incidence %>%
rename(I = cases)
res_parametric_si <- estimate_R(
incid  = ebola_sierraleone_2014_epiestim,       # data.frame with columns "date" (optional) and "I"
method = "parametric_si",
config = make_config(list(
mean_si = mean_si,
std_si  = std_si
))
)
library(ggplot2)
# Inspect and plot
head(res_parametric_si$R)
plot(res_parametric_si, legend = FALSE)      # full 3-panel plot
plot(res_parametric_si, "R") +               # Rt only
geom_hline(aes(yintercept = 1), lty = 2, col = "red")
load_all()
# Load necessary libraries
library(dplyr)
library(outbreaks)
# Data
data(ebola_sierraleone_2014)
# 1) Build daily incidence data frame (time, cases)
ebola_daily_incidence <- ebola_sierraleone_2014 %>%
filter(!is.na(date_of_onset)) %>%
group_by(date_of_onset) %>%
summarise(cases = n(), .groups = "drop") %>%
arrange(date_of_onset) %>%
mutate(time = row_number()) %>%
select(time, cases) %>%
as.data.frame()
# 4) Run model
out <- estimate_Rt(
incidence = ebola_daily_incidence,
N = 100000,
gamma = 0.2
)
head(out$Rt_series)
out$Rt_plot # print Rt(t) plot over time
library(EpiEstim)
# Ebola SI parameters (tune if you have study-specific estimates)
mean_si <- 15    # days
std_si  <- 9.5   # days
library(dplyr)
ebola_sierraleone_2014_epiestim <- ebola_daily_incidence %>%
rename(I = cases)
t_start = c(1, 50)
t_end = c(49, nrow(ebola_daily_incidence))
res_parametric_si <- estimate_R(
incid  = ebola_sierraleone_2014_epiestim,       # data.frame with columns "date" (optional) and "I"
method = "non_parametric_si",
config = make_config(list(
mean_si = mean_si,
std_si  = std_si,
t_start = t_start,
t_end = t_end
))
)
# Load necessary libraries
library(dplyr)
library(outbreaks)
# Data
data(ebola_sierraleone_2014)
# 1) Build daily incidence data frame (time, cases)
ebola_daily_incidence <- ebola_sierraleone_2014 %>%
filter(!is.na(date_of_onset)) %>%
group_by(date_of_onset) %>%
summarise(cases = n(), .groups = "drop") %>%
arrange(date_of_onset) %>%
mutate(time = row_number()) %>%
select(time, cases) %>%
as.data.frame()
# 4) Run model
out <- estimate_Rt(
incidence = ebola_daily_incidence,
N = 100000,
gamma = 0.2
)
head(out$Rt_series)
out$Rt_plot # print Rt(t) plot over time
library(EpiEstim)
# Ebola SI parameters (tune if you have study-specific estimates)
mean_si <- 15    # days
std_si  <- 9.5   # days
library(dplyr)
ebola_sierraleone_2014_epiestim <- ebola_daily_incidence %>%
rename(I = cases)
t_start = c(2, 50)
t_end = c(49, nrow(ebola_daily_incidence))
res_parametric_si <- estimate_R(
incid  = ebola_sierraleone_2014_epiestim,       # data.frame with columns "date" (optional) and "I"
method = "non_parametric_si",
config = make_config(list(
mean_si = mean_si,
std_si  = std_si,
t_start = t_start,
t_end = t_end
))
)
library(EpiEstim)
library(dplyr)
library(ggplot2)
# ---- Your SI (parametric) ----
mean_si <- 15     # days
std_si  <- 9.5    # days
# ---- Prepare incidence ----
# Expecting ebola_daily_incidence to have columns: date (optional), cases (integer)
ebola_sierraleone_2014_epiestim <- ebola_daily_incidence %>%
rename(I = cases)  # EpiEstim looks for column "I"
# ---- Define NON-OVERLAPPING windows ----
# Example: 2..49 (pre), 50..N (post)
t_start <- c(2, 50)
t_end   <- c(49, nrow(ebola_daily_incidence))
stopifnot(length(t_start) == length(t_end))
stopifnot(all(t_start >= 2))
stopifnot(all(t_end <= nrow(ebola_daily_incidence)))
stopifnot(all(t_end >= t_start))
# ---- Estimate R over the two windows ----
res_parametric_si <- estimate_R(
incid  = ebola_sierraleone_2014_epiestim,  # data.frame with "I" (and optionally "dates")
method = "parametric_si",
config = make_config(list(
mean_si = mean_si,
std_si  = std_si,
t_start = t_start,
t_end   = t_end
))
)
# ---- Inspect and plot ----
head(res_parametric_si$R)
# Full 3-panel plot
plot(res_parametric_si, legend = FALSE)
# Rt panel only + horizontal line at 1
plot(res_parametric_si, "R") +
geom_hline(aes(yintercept = 1), lty = 2, col = "red")
# ---- (Optional) Summarise mean R per window ----
summary_by_window <- res_parametric_si$R %>%
mutate(window = paste0("days ", t_start, "â€“", t_end)) %>%
select(window, `Mean(R)`, `Quantile.0.025(R)`, `Quantile.0.975(R)`)
print(summary_by_window)
